{% extends "index.html" %}
{% load static %}
{% load color_filters %}
{% block content %}
    {% include "partials/spinner.html" with id="body_spinner" %}
    <div class="flex h-full flex-col" id="main_body">
        {% block header %}
            <div class="h-16 flex items-center justify-between px-4">
                {% include "partials/table_filter.html" with view_name="All Payments" %}
                <a href="{% url 'add_payment' %}"
                   hx-boost="true"
                   hx-target="#main_body"
                   hx-indicator="#body_spinner"
                   class="px-3 py-2 text-sm font-medium text-center inline-flex items-center text-white bg-brand-500 rounded-md hover:bg-blue-600 focus:ring-1 focus:outline-none focus:ring-blue-200">
                    <svg xmlns="http://www.w3.org/2000/svg"
                         viewBox="0 0 20 20"
                         fill="currentColor"
                         class="size-5">
                        <path d="M10.75 4.75a.75.75 0 0 0-1.5 0v4.5h-4.5a.75.75 0 0 0 0 1.5h4.5v4.5a.75.75 0 0 0 1.5 0v-4.5h4.5a.75.75 0 0 0 0-1.5h-4.5v-4.5Z" />
                    </svg>
                    New
                </a>
            </div>
        {% endblock header %}
        {% block body %}
            <div class="flex-1 overflow-y-auto">
                <div class="relative overflow-x-auto" id="table_container">
                    {% block table_with_pagination %}
                        <!-- TABLE -->
                        <table class="w-full text-sm text-left text-gray-500">
                            <thead class="text-xs text-gray-500 font-normal uppercase bg-gray-50 sticky top-0 z-10">
                                <tr class="border-t border-b">
                                    <th scope="col" class="px-6 py-3">Date</th>
                                    <th scope="col" class="px-6 py-3">Payment #</th>
                                    <th scope="col" class="px-6 py-3">PO #</th>
                                    <th scope="col" class="px-6 py-3">Supplier Name</th>
                                    <th scope="col" class="px-6 py-3">Mode</th>
                                    <th scope="col" class="px-6 py-3">Status</th>
                                    <th scope="col" class="px-6 py-3 text-right">Amount</th>
                                </tr>
                            </thead>
                            <tbody class="text-sm text-black font-light">
                                {% if payments %}
                                    {% for payment in payments %}
                                        <tr class="bg-white border-b border-gray-100 hover:bg-gray-50">
                                            <td class="px-6 py-3 capitalize">{{ payment.payment_date|date:"j F Y g:i A" }}</td>
                                            <td class="px-6 py-3">{{ payment.trxn_ref }}</td>
                                            <td class="px-6 py-3 capitalize">{{ payment.purchase_order.po_number }}</td>
                                            <td class="px-6 py-3 capitalize">{{ payment.purchase_order.supplier.name }}</td>
                                            <td class="px-6 py-3 capitalize">{{ payment.payment_method }}</td>
                                            <td class="px-6 py-3 capitalize {{ payment.status|status_color }}">{{ payment.status|upper }}</td>
                                            <td class="px-6 py-3 text-right">NGN{{ payment.amount_paid|floatformat:"2g" }}</td>
                                        </tr>
                                    {% endfor %}
                                {% else %}
                                    <tr class="bg-white border-b border-gray-100 hover:bg-gray-50">
                                        <td colspan="7" class="px-6 py-3 text-center">
                                            <p>No payments have been recorded yet.</p>
                                        </td>
                                    </tr>
                                {% endif %}
                            </tbody>
                        </table>
                        <!-- PAGINATION -->
                        <div id="pagination">{% include 'partials/pagination.html' with page_obj=payments target="table_container" %}</div>
                    {% endblock table_with_pagination %}
                </div>
            </div>
        {% endblock body %}
    </div>
{% endblock content %}
